# Kimigayo OS 脆弱性報告ガイド

## 概要

Kimigayo OSプロジェクトでは、セキュリティ研究者やコミュニティメンバーからの責任ある脆弱性の開示を歓迎します。このガイドでは、脆弱性を報告する方法と、報告後のプロセスについて説明します。

## 重要な原則

### 責任ある開示

- **公開前に報告**: 脆弱性を公開する前に、セキュリティチームに報告してください
- **修正の時間を確保**: パッチが準備されるまで、詳細の公開を控えてください
- **協力的な姿勢**: セキュリティチームと協力して問題を解決してください

### プライバシーと機密性

報告された脆弱性情報は厳重に管理され、修正版がリリースされるまで機密として扱われます。

## 報告方法

### 方法1: GitHub Security Advisory（推奨）

最も推奨される報告方法です。

1. [Kimigayo OSリポジトリ](https://github.com/Kazuki-0731/Kimigayo)にアクセス
2. 「Security」タブをクリック
3. 「Advisories」→「Report a vulnerability」をクリック
4. フォームに脆弱性の詳細を記入
5. 「Submit report」をクリック

**利点**:
- プライベートな議論が可能
- GitHubが通知を管理
- パッチの協力開発が容易

### 方法2: 暗号化メール

機密性の高い脆弱性の場合は、暗号化メールを使用してください。

**メールアドレス**: security@kimigayo-os.org

**PGP公開鍵**:
```
-----BEGIN PGP PUBLIC KEY BLOCK-----

[PGP公開鍵はここに配置]

-----END PGP PUBLIC KEY BLOCK-----
```

**公開鍵の取得**:
```bash
# Webから取得
curl https://kimigayo-os.org/security/pgp-key.asc | gpg --import

# キーサーバーから取得
gpg --keyserver keys.openpgp.org --recv-keys FINGERPRINT
```

**PGPフィンガープリント**: `XXXX XXXX XXXX XXXX XXXX XXXX XXXX XXXX`

**メールの暗号化方法**:
```bash
# メッセージを暗号化
gpg --encrypt --armor --recipient security@kimigayo-os.org message.txt

# 暗号化されたメッセージをメールで送信
```

### 方法3: セキュリティホットライン（緊急時のみ）

**重大な脆弱性で即座の対応が必要な場合のみ**:
- メール: emergency@kimigayo-os.org
- 暗号化推奨

## 報告に含めるべき情報

### 必須情報

1. **脆弱性の概要**
   - 簡潔な説明（1-2文）
   - 脆弱性の種類（バッファオーバーフロー、権限昇格、情報漏洩など）

2. **影響を受けるコンポーネント**
   - パッケージ名
   - バージョン
   - アーキテクチャ（x86_64, ARM64など）

3. **再現手順**
   - ステップバイステップの詳細な手順
   - 必要な環境設定
   - 使用したコマンドやスクリプト

4. **影響範囲**
   - 脆弱性の深刻度（自己評価でOK）
   - 悪用の条件（ローカル/リモート、認証の有無）
   - 実際の影響（情報漏洩、サービス停止、権限昇格など）

### 推奨情報

5. **概念実証（PoC）**
   ```bash
   # 脆弱性を実証するスクリプトやコマンド
   ```

6. **推奨される緩和策**
   - 一時的な回避策
   - 修正案（可能であれば）

7. **参考情報**
   - 関連するCVE
   - 類似の脆弱性レポート
   - 参考文献

### 報告テンプレート

```markdown
# 脆弱性レポート

## 概要
[脆弱性の簡潔な説明]

## 影響を受けるコンポーネント
- パッケージ: [パッケージ名]
- バージョン: [バージョン番号]
- アーキテクチャ: [x86_64 / ARM64]

## 脆弱性の詳細
### 種類
[バッファオーバーフロー / 権限昇格 / 情報漏洩 / その他]

### 深刻度（自己評価）
[Critical / High / Medium / Low]

### 悪用条件
- アクセスレベル: [ローカル / リモート]
- 認証: [必要 / 不要]
- ユーザー操作: [必要 / 不要]

## 再現手順
1. [ステップ1]
2. [ステップ2]
3. [ステップ3]

```bash
# 再現コマンド
```

## 期待される動作
[正常な動作の説明]

## 実際の動作
[脆弱性による異常な動作の説明]

## 概念実証（PoC）
```bash
#!/bin/bash
# PoC スクリプト
```

## 影響範囲
[脆弱性による影響の詳細]

## 推奨される緩和策
[一時的な回避策や修正案]

## 参考情報
- 関連CVE: CVE-XXXX-XXXXX
- 参考URL: https://...

## 報告者情報（任意）
- 名前: [お名前]
- 所属: [組織名]
- 連絡先: [メールアドレス]
- クレジット希望: [Yes / No]
```

## 報告後のプロセス

### 1. 受領確認（24時間以内）

セキュリティチームから受領確認メールが届きます。

```
件名: [Kimigayo Security] 脆弱性レポート受領確認 #XXXX

お世話になっております。
Kimigayo OSセキュリティチームです。

脆弱性レポート（#XXXX）を受領いたしました。
現在、チームで内容を精査しております。

72時間以内に初期評価結果をご連絡いたします。

よろしくお願いいたします。
```

### 2. 初期評価（72時間以内）

脆弱性の深刻度と影響範囲を評価し、対応方針をお知らせします。

**深刻度の分類**:

| 深刻度 | 説明 | 対応期限 |
|--------|------|---------|
| **Critical** | リモートコード実行、権限昇格（認証不要） | 7日以内 |
| **High** | 権限昇格（認証必要）、重大な情報漏洩 | 30日以内 |
| **Medium** | サービス停止、限定的な情報漏洩 | 90日以内 |
| **Low** | 軽微な情報漏洩、設定の問題 | 次回リリース時 |

### 3. 修正作業

セキュリティチームがパッチの開発を開始します。

- 進捗状況を定期的に報告
- 必要に応じて追加情報を依頼
- パッチのレビューへの協力をお願いする場合があります

### 4. パッチの検証

開発されたパッチの有効性を検証します。

- 報告者によるパッチの検証（任意）
- 内部テスト
- 回帰テストの実施

### 5. セキュリティアドバイザリの準備

修正版リリースと同時に公開するアドバイザリを準備します。

- 脆弱性の詳細
- 影響範囲
- 修正内容
- 回避策
- クレジット（報告者の希望に応じて）

### 6. 調整された開示

報告者と協議の上、開示日を決定します。

**デフォルトの開示ポリシー**:
- パッチリリース後、即座に開示
- または報告から90日後（パッチが未完成でも）

**開示内容**:
- セキュリティアドバイザリの公開
- CVE番号の取得と公開
- パッチのリリース
- ユーザーへの通知

### 7. 事後対応

- ユーザーによるパッチ適用状況の監視
- 追加の質問への対応
- 類似の脆弱性の調査

## 深刻度の評価基準

Kimigayo OSは、CVSS（Common Vulnerability Scoring System）v3.1を使用して脆弱性を評価します。

### CVSS計算ツール

オンライン計算ツール: https://www.first.org/cvss/calculator/3.1

### 評価の例

**例1: リモートコード実行（Critical）**
- Attack Vector: Network (AV:N)
- Attack Complexity: Low (AC:L)
- Privileges Required: None (PR:N)
- User Interaction: None (UI:N)
- Impact: High (C:H/I:H/A:H)
- **CVSS Score: 9.8 (Critical)**

**例2: ローカル権限昇格（High）**
- Attack Vector: Local (AV:L)
- Attack Complexity: Low (AC:L)
- Privileges Required: Low (PR:L)
- User Interaction: None (UI:N)
- Impact: High (C:H/I:H/A:H)
- **CVSS Score: 7.8 (High)**

## よくある質問（FAQ）

### Q1: 報告は匿名でも可能ですか？

はい、匿名での報告も可能です。ただし、追加情報が必要な場合に連絡できる方法を提供していただけると助かります。

### Q2: 報告後、どれくらいで修正されますか？

深刻度によりますが、Criticalな脆弱性は7日以内、Highは30日以内に修正を目指します。

### Q3: 自分の名前をクレジットに載せてほしくないのですが？

問題ありません。報告時にその旨をお知らせください。

### Q4: サードパーティパッケージの脆弱性も報告すべきですか？

はい、報告してください。Kimigayo OSに含まれるパッケージであれば、上流にエスカレーションします。

### Q5: 脆弱性を発見したが、詳細を調査する時間がありません

概要だけでも報告してください。セキュリティチームが詳細を調査します。

### Q6: 90日経ってもパッチがリリースされない場合は？

報告から90日後は、公開する権利があります。ただし、事前にセキュリティチームと協議してください。

## 対象範囲

### 対象となるコンポーネント

- Kimigayo OSカーネル
- コアシステムユーティリティ
- パッケージマネージャ（isn）
- Initシステム（OpenRC）
- デフォルトでインストールされるパッケージ
- ビルドシステム

### 対象外となるもの

- サードパーティアプリケーション（ただし上流にエスカレーション可能）
- ドキュメントの誤記（セキュリティに影響しない場合）
- 推奨設定外の構成での問題

## セキュリティチーム

### メンバー

- セキュリティリード: [名前]
- カーネルセキュリティ: [名前]
- パッケージセキュリティ: [名前]

### PGP公開鍵

すべてのセキュリティチームメンバーのPGP公開鍵は以下で入手できます:
- https://kimigayo-os.org/security/team-keys.asc

## 関連リソース

- [セキュリティポリシー](SECURITY_POLICY.md)
- [セキュリティガイド](SECURITY_GUIDE.md)
- [セキュリティアドバイザリ](https://github.com/Kazuki-0731/Kimigayo/security/advisories)
- [CVSSv3.1計算ツール](https://www.first.org/cvss/calculator/3.1)

## 連絡先

- **一般的な脆弱性報告**: security@kimigayo-os.org
- **緊急（Critical）**: emergency@kimigayo-os.org
- **PGP公開鍵**: https://kimigayo-os.org/security/pgp-key.asc

---

**最終更新**: 2025-12-15

ご協力ありがとうございます。Kimigayo OSのセキュリティ向上にご協力いただき、心より感謝いたします。
